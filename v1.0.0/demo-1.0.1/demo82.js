var L=(e,p,c)=>new Promise((U,h)=>{var y=i=>{try{n(c.next(i))}catch(d){h(d)}},a=i=>{try{n(c.throw(i))}catch(d){h(d)}},n=i=>i.done?U(i.value):Promise.resolve(i.value).then(y,a);n((c=c.apply(e,p)).next())});import{c as T}from"./mobile.js";import{d as N,a as k,x as F,ar as O,_ as I,r as D,b as $,e as s,t as l,k as t,w as m,o as V,l as w}from"./style_icon.js";import{s as z}from"./index.js";import"./Success.js";const{translate:f}=T("uploader"),X=()=>O({"zh-CN":{basic:"基础用法",uploadfile:"上传文件",title1:"上传状态",title2:"基础用法-上传列表展示",title3:"自定义上传样式",title4:"自定义上传配合使用默认进度条",title5:"直接调起摄像头（移动端生效）",title6:"限制上传数量5个",title7:"限制上传大小（每个文件最大不超过 50kb）",title8:"图片压缩（在 beforeupload 钩子中处理）",title9:"自定义数据 FormData 、 headers ",title10:"选中文件后，通过按钮手动执行上传",title11:"手动执行上传",title12:"禁用状态",title13:"自定义 xhr 上传方式(before-xhr-upload)",title14:"手动清空上传"},"en-US":{basic:"Basic Usage",uploadfile:"Upload files",title1:"Upload status",title2:"Basic usage - upload list display",title3:"Custom upload style",title4:"Custom upload uses default progress bar",title5:"Directly activate the camera (effective on the mobile terminal)",title6:"Limit the number of uploads to 5",title7:"Limit upload size (up to 50kb per file)",title8:"Image compression (handled in the beforeupload hook)",title9:"Custom data FormData , headers",title10:"Once the file is selected, manually perform the upload via the button",title11:"Manual upload",title12:"Disabled state",title13:"Customize XHR upload (before-xhr-upload)",title14:"Clear upload manually"}}),E=N({setup(){X();const e="https://my-json-server.typicode.com/linrufeng/demo/posts",p=k(0),c={custom:"test"},U=F([{name:"file 1.png",url:"https://oss.netconcepts.cn/website/assets/media/wap/blog-wap-bg-1.jpg",status:"success",message:f("success"),type:"image"},{name:"file 2.png",url:"https://oss.netconcepts.cn/website/assets/media/wap/blog-wap-bg-1.jpg",status:"error",message:f("error"),type:"image"},{name:"file 3.png",url:"https://oss.netconcepts.cn/website/assets/media/wap/blog-wap-bg-1.jpg",status:"uploading",message:f("uploading"),type:"image"}]),h=F([{name:"file 1.png",url:"https://oss.netconcepts.cn/website/assets/media/wap/blog-wap-bg-1.jpg",status:"success",message:f("success"),type:"image"},{name:"file 2.png",url:"https://oss.netconcepts.cn/website/assets/media/wap/blog-wap-bg-1.jpg",status:"error",message:f("error"),type:"image"},{name:"file 3.png",url:"https://oss.netconcepts.cn/website/assets/media/wap/blog-wap-bg-1.jpg",status:"uploading",message:f("uploading"),type:"image"}]),y=o=>new Promise(u=>{const r=new FileReader;r.onloadend=b=>u(b.target.result),r.readAsDataURL(o)}),a=o=>new Promise(u=>{const r=new Image;r.onload=()=>u(r),r.src=o}),n=(o,u,r)=>new Promise(b=>o.toBlob(C=>b(C),u,r)),i=()=>{z.text("oversize 触发 文件大小不能超过 50kb")},d=()=>{z.text("delete 事件触发")},P=({percentage:o})=>{p.value=o,z.text("progress 事件触发"+o)},j=o=>L(this,null,function*(){let u=o[0].name;const r=document.createElement("canvas"),b=r.getContext("2d"),C=yield y(o[0]),g=yield a(C);r.width=g.width,r.height=g.height,b.clearRect(0,0,g.width,g.height),b.drawImage(g,0,0,g.width,g.height);let B=yield n(r,"image/jpeg",.5);return[yield new File([B],u)]}),R=(o,u)=>{u.method.toLowerCase()=="put"?o.send(u.sourceFile):o.send(u.formData)},v=k(null);return{onOversize:i,beforeUpload:j,beforeXhrUpload:R,onDelete:d,onProgress:P,progressPercentage:p,uploadUrl:e,defaultFileList:U,defaultFileList1:h,formData:c,uploadRef:v,submitUpload:()=>{v.value.submit()},clearUpload:()=>{v.value.clearUploadQueue()},translate:f}}}),S={class:"demo bg-w"},A=s("br",null,null,-1),H=s("br",null,null,-1);function M(e,p,c,U,h,y){const a=D("cub-uploader"),n=D("cub-button"),i=D("cub-progress");return V(),$("div",S,[s("h2",null,l(e.translate("basic")),1),t(a,{url:e.uploadUrl},null,8,["url"]),s("h2",null,l(e.translate("title1")),1),t(a,{url:e.uploadUrl,"file-list":e.defaultFileList,"onUpdate:fileList":p[0]||(p[0]=d=>e.defaultFileList=d),onDelete:e.onDelete,maximum:"3",multiple:""},null,8,["url","file-list","onDelete"]),s("h2",null,l(e.translate("title2")),1),t(a,{url:e.uploadUrl,"file-list":e.defaultFileList1,"onUpdate:fileList":p[1]||(p[1]=d=>e.defaultFileList1=d),maximum:"10",multiple:"","list-type":"list"},{default:m(()=>[t(n,{type:"success",size:"small"},{default:m(()=>[w(l(e.translate("uploadfile")),1)]),_:1})]),_:1},8,["url","file-list"]),s("h2",null,l(e.translate("title3")),1),t(a,{url:e.uploadUrl},{default:m(()=>[t(n,{type:"success",size:"small"},{default:m(()=>[w(l(e.translate("uploadfile")),1)]),_:1})]),_:1},8,["url"]),s("h2",null,l(e.translate("title4")),1),t(a,{url:e.uploadUrl,onProgress:e.onProgress},{default:m(()=>[t(n,{type:"success",size:"small"},{default:m(()=>[w(l(e.translate("uploadfile")),1)]),_:1})]),_:1},8,["url","onProgress"]),A,t(i,{percentage:e.progressPercentage,"stroke-color":"linear-gradient(270deg, rgba(18,126,255,1) 0%,rgba(32,147,255,1) 32.815625%,rgba(13,242,204,1) 100%)",status:e.progressPercentage==100?"":"active"},null,8,["percentage","status"]),s("h2",null,l(e.translate("title5")),1),t(a,{url:e.uploadUrl,capture:""},null,8,["url"]),s("h2",null,l(e.translate("title6")),1),t(a,{url:e.uploadUrl,multiple:"",maximum:"5"},null,8,["url"]),s("h2",null,l(e.translate("title7")),1),t(a,{url:e.uploadUrl,multiple:"",maximize:1024*50,onOversize:e.onOversize},null,8,["url","onOversize"]),s("h2",null,l(e.translate("title8")),1),t(a,{url:e.uploadUrl,multiple:"","before-upload":e.beforeUpload},null,8,["url","before-upload"]),s("h2",null,l(e.translate("title9")),1),t(a,{url:e.uploadUrl,data:e.formData,headers:e.formData,"with-credentials":!0},null,8,["url","data","headers"]),s("h2",null,l(e.translate("title13")),1),t(a,{url:e.uploadUrl,method:"put","before-xhr-upload":e.beforeXhrUpload},null,8,["url","before-xhr-upload"]),s("h2",null,l(e.translate("title10")),1),t(a,{url:e.uploadUrl,maximum:"5","auto-upload":!1,ref:"uploadRef"},null,8,["url"]),H,t(n,{type:"success",size:"small",onClick:e.submitUpload},{default:m(()=>[w(l(e.translate("title11")),1)]),_:1},8,["onClick"]),t(n,{type:"danger",size:"small",onClick:e.clearUpload},{default:m(()=>[w(l(e.translate("title14")),1)]),_:1},8,["onClick"]),s("h2",null,l(e.translate("title12")),1),t(a,{disabled:""})])}const _=I(E,[["render",M]]);export{_ as default};
